<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Visor Soporte de Casco 3D - Kreoma3D</title>
  <style>
  :root{
    --panel:#ffffffee; --txt:#111; --border:#e6e6e6;
    --shadow:0 10px 25px rgba(0,0,0,.18);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{
    height:100vh; overflow:hidden;
    background:#ccc; color:var(--txt);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  }

  .bg-logo{
    position:fixed; inset:0; z-index:0;
    background:url('logo_kreoma.png') center center no-repeat;
    background-size:150vmin;
    opacity:0;
    pointer-events:none;
  }

.topbar{
  position:fixed; top:0; left:0; right:0; height:56px; z-index:20;
  display:flex; align-items:center; justify-content:space-between;
  padding:0 20px;
  background:#fff; border-bottom:1px solid var(--border); box-shadow:var(--shadow);
}
.topbar img{height:34px;cursor:pointer;}
.topbar h1{
  font-size:16px; font-weight:600;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  margin:0 20px; flex:1; text-align:center;
}
.topbar nav a{
  color:#111; text-decoration:none; margin-left:18px;
  font-weight:500; transition:.3s;
}
.topbar nav a:hover{color:#f33;}


  #panel{
    position:fixed; top:72px; left:16px; z-index:10;
    background:var(--panel); border:1px solid var(--border);
    padding:14px 16px; border-radius:14px; box-shadow:var(--shadow);
    width:340px; max-width:90vw;
    backdrop-filter:saturate(1.2) blur(6px);
    overflow-y:auto; max-height:calc(100vh - 100px);
  }

  h3{
    margin:8px 0 6px;
    font-size:13px;
    text-transform:uppercase;
    letter-spacing:.6px;
  }

  select, button{
    width:100%; padding:10px 12px; margin-bottom:12px;
    border-radius:10px; border:1px solid var(--border);
    font-size:15px; background:#fff;
  }

  button{
    background:#25D366; color:#fff; border:none;
    font-weight:600; cursor:pointer; transition:background .2s;
  }
  button:hover{background:#1ebe5c;}

  @media(max-width:768px){
    .topbar{
      height:auto; padding:10px; flex-wrap:wrap; text-align:center; justify-content:center;
    }
    .topbar img{height:28px;}
    .topbar h1{font-size:14px;}
    #panel{
      position:fixed; top:auto; bottom:0; left:0; right:0;
      width:100%; max-width:none; border-radius:20px 20px 0 0;
      border-top:1px solid var(--border); box-shadow:0 -4px 20px rgba(0,0,0,.25);
      padding:16px 20px; background:#ffffffee;
    }
    h3{font-size:12px; margin-top:6px;}
    select, button{font-size:14px;}
  }

  @media(max-width:480px){
    #panel{padding:12px 16px;}
    .topbar h1{font-size:13px;}
  }
</style>

</head>
<body>
  <div class="bg-logo"></div>

  <div class="topbar">
      <a href="../../index.html">
    <img src="logo_kreoma.png" alt="Kreoma3D" style="height:50px;cursor:pointer;">
  </a>

  <h1>Personalizador 3D â€¢ Soporte de casco 3 en 1 </h1>

  <nav>
    <a href="../index.html">Inicio</a>
    <a href="../index.html#productos">Productos</a>
    <a href="../index.html#contacto">Contacto</a>
  </nav>
</div>
 

  <div id="panel">
    <h3>Color Base</h3>
    <select id="color-base"></select>
    <h3>Color Superior</h3>
    <select id="color-superior"></select>
    <h3>Color Insertos</h3>
    <select id="color-insert"></select>

    <h3>Logo</h3>
    <select id="logo-select"></select>
    <h3>Color Logo</h3>
    <select id="color-logo"></select>

    <button id="enviarWhatsApp" style="
      width:100%;padding:10px 0;margin-top:10px;
      background:#25D366;color:#fff;border:none;
      border-radius:8px;font-weight:600;cursor:pointer;">
      Enviar PersonalizaciÃ³n a WhatsApp
    </button>
  </div>

  <script type="module">
    import * as THREE from './libs/three.module.js';
    import { STLLoader } from './libs/STLLoader.js';
    import { OrbitControls } from './libs/OrbitControls.js';

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 0.1, 10000);
    camera.position.set(-200,0,200);

    const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
    renderer.setClearColor(0x000000, 0);
    renderer.setSize(innerWidth, innerHeight);
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    document.body.appendChild(renderer.domElement);

    const hemi = new THREE.HemisphereLight(0xffffff, 0x888888, 1.3);
    scene.add(hemi);
    const dir = new THREE.DirectionalLight(0xffffff, 0.9);
    dir.position.set(1,1,1);
    scene.add(dir);
    scene.add(new THREE.AmbientLight(0xffffff, 0.4));

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.dampingFactor = 0.07;

    const worldGroup = new THREE.Group();
    worldGroup.position.y = -160;
    worldGroup.position.x = 170;
    scene.add(worldGroup);

    const loader = new STLLoader();

    const piezas = {
      base: { file:'Helm-Wandhalter.stl', mesh:null },
      superior: { file:'Helm-Halter.stl', mesh:null },
      inserts: ['Insert1.stl','Insert2.stl','Insert3.stl','Insert4.stl','Insert5.stl'],
      insertMeshes:[],
      logo: { file:'logoYamaha.stl', mesh:null }
    };

    function cargar(){
      loader.load(piezas.base.file,g=>{
        const m=new THREE.Mesh(g,new THREE.MeshStandardMaterial({color:'#000',metalness:0.4,roughness:0.35}));
        m.rotation.x=Math.PI; m.rotation.z=Math.PI; worldGroup.add(m);
        piezas.base.mesh=m;
      });

      loader.load(piezas.superior.file,g=>{
        const m=new THREE.Mesh(g,new THREE.MeshStandardMaterial({color:'#ff8000',metalness:0.4,roughness:0.35}));
        m.rotation.x=Math.PI; m.rotation.z=Math.PI; worldGroup.add(m);
        piezas.superior.mesh=m;
      });

      piezas.inserts.forEach(f=>{
        loader.load(f,g=>{
          const m=new THREE.Mesh(g,new THREE.MeshStandardMaterial({color:'#ff8000',metalness:0.4,roughness:0.35}));
          m.rotation.x=Math.PI; m.rotation.z=Math.PI; worldGroup.add(m);
          piezas.insertMeshes.push(m);
        });
      });

      cargarLogo('logoYamaha.stl','#ff8000');
    }

    function cargarLogo(nombreArchivo,color){
  // eliminar logo anterior si existe
  if(piezas.logo.mesh){
    worldGroup.remove(piezas.logo.mesh);
    piezas.logo.mesh.geometry.dispose();
    piezas.logo.mesh.material.dispose();
    piezas.logo.mesh=null;
  }

  // si el valor estÃ¡ vacÃ­o, no carga nada
  if(!nombreArchivo) return;

  loader.load(nombreArchivo,g=>{
    const m=new THREE.Mesh(g,new THREE.MeshStandardMaterial({color:color,metalness:0.4,roughness:0.35}));
    m.rotation.x=Math.PI;
    m.rotation.z=Math.PI;
    m.position.set(11,-15,-5);
    worldGroup.add(m);
    piezas.logo.mesh=m;
  });
}

    function cambiarLogo(){
      const nombre=document.getElementById('logo-select').value;
      const color=document.getElementById('color-logo').value;
      cargarLogo(nombre,color);
    }

    const colores=[
      {n:'Amarillo',c:'#ffff00'},
      {n:'Blanco',c:'#ffffff'},
      {n:'Negro',c:'#000000'},
      {n:'Azul',c:'#0000ff'},
      {n:'Verde limÃ³n',c:'#ccff00'},
      {n:'Rosado',c:'#ff66cc'},
      {n:'Morado',c:'#8000ff'},
      {n:'CafÃ©',c:'#8b4513'},
      {n:'Rojo',c:'#ff0000'},
      {n:'Gris',c:'#808080'},
      {n:'Naranjado',c:'#ff8000'}
    ];

    function crearSelect(id,grupo,colorInicial){
      const sel=document.getElementById(id);
      colores.forEach(c=>{
        const opt=document.createElement('option');
        opt.value=c.c;
        opt.textContent=c.n;
        opt.style.background=c.c;
        opt.style.color=(parseInt(c.c.slice(1),16)>0xffffff/2)?'#000':'#fff';
        sel.appendChild(opt);
      });
      sel.value=colorInicial;
      sel.addEventListener('change',()=>aplicarColor(grupo,sel.value));
    }

    function aplicarColor(grupo,col){
      if(grupo==='base'&&piezas.base.mesh)piezas.base.mesh.material.color.set(col);
      if(grupo==='superior'&&piezas.superior.mesh)piezas.superior.mesh.material.color.set(col);
      if(grupo==='insert')piezas.insertMeshes.forEach(m=>m.material.color.set(col));
      if(grupo==='logo'&&piezas.logo.mesh)piezas.logo.mesh.material.color.set(col);
    }

    const logos=[
      {n:'Yamaha',f:'logoYamaha.stl'},
      {n:'Sin logo',f:''},  // â† nueva opciÃ³n vacÃ­a
      {n:'Ktm',f:'logoKtm.stl'},
      {n:'Monster',f:'logoMonster.stl'},
      {n:'Honda',f:'logoHonda.stl'},
      {n:'Suzuki',f:'logoSuzuki.stl'},
      {n:'AKT',f:'logoAKT.stl'}
    ];

    function crearSelectLogos(){
      const sel=document.getElementById('logo-select');
      logos.forEach(l=>{
        const opt=document.createElement('option');
        opt.value=l.f;
        opt.textContent=l.n;
        sel.appendChild(opt);
      });
      sel.addEventListener('change',cambiarLogo);
    }

    cargar();
    crearSelect('color-base','base','#000000');
    crearSelect('color-superior','superior','#ff8000');
    crearSelect('color-insert','insert','#ff8000');
    crearSelect('color-logo','logo','#ff8000');
    crearSelectLogos();
    document.getElementById('color-logo').addEventListener('change',cambiarLogo);

    function animate(){
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene,camera);
    }
    animate();

    addEventListener('resize',()=>{
      camera.aspect=innerWidth/innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth,innerHeight);
    });

    document.getElementById('enviarWhatsApp').addEventListener('click',()=>{
      const base=document.getElementById('color-base').selectedOptions[0].textContent;
      const sup=document.getElementById('color-superior').selectedOptions[0].textContent;
      const ins=document.getElementById('color-insert').selectedOptions[0].textContent;
      const logo=document.getElementById('logo-select').selectedOptions[0].textContent;
      const colorLogo=document.getElementById('color-logo').selectedOptions[0].textContent;
      const mensaje=`Hola Kreoma3D! ðŸ‘‹\nQuiero mi soporte 3 en 1 personalizado con:\nâ€¢ Base: ${base}\nâ€¢ Superior: ${sup}\nâ€¢ Insertos: ${ins}\nâ€¢ Logo: ${logo} (${colorLogo})`;
      const url=`https://wa.me/573332395481?text=${encodeURIComponent(mensaje)}`;
      window.open(url,'_blank');
    });
  </script>
</body>
</html>








